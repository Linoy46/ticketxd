<!--Tutorial-->
<app-tutorial [config]="tutorialConfig" buttonText="Ayuda" [showButton]="true">
</app-tutorial>

<header class="header text-center text-secondary mb-4">
  <h1>Gestión de Techos Presupuestales</h1>
</header>

<div class="max-w-7xl mx-auto">
  <!-- Barra de búsqueda y controles -->
  <div
    class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2 btn-align-mobile-wrapper"
  >
    <div class="d-flex align-items-center flex-wrap gap-2">
      <button
        *ngIf="hasPermission('Financieros:view_add_button')"
        class="btn btn-sm btn-purple me-2"
        (click)="openAddDialog()"
        id="nuevo_techo"
      >
        <i class="bi bi-plus-lg me-1"></i> Nuevo Techo Presupuestal
      </button>
      <!-- Botón de exportar Excel -->
      <button
        class="btn btn-sm btn-secondary"
        (click)="exportToExcel()"
        [disabled]="false"
        id="excel"
        title="Exportar Excel (Deshabilitado)"
      >
        <i class="bi bi-file-earmark-excel me-1"></i> Exportar Excel
      </button>
    </div>
  </div>

  <!-- Indicador de carga -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner-border text-purple" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-3">Cargando datos de techos presupuestales...</p>
  </div>

  <!-- Tabla de techos presupuestales -->
  <div *ngIf="!loading" class="grid-container">
    <ag-grid-angular
      class="ag-theme-quartz grid-responsive"
      style="
        width: 100%;
        height: 100%;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      "
      [rowData]="filteredData"
      [columnDefs]="columnDefs"
      [gridOptions]="gridOptions"
      [pagination]="true"
      [theme]="myTheme"
      (gridReady)="onGridReady($event)"
    >
    </ag-grid-angular>
  </div>

  <!-- Mensaje cuando no hay datos -->
  <div
    *ngIf="!loading && filteredData.length === 0"
    class="text-center py-5 border-top border-bottom my-3"
  >
    <i class="bi bi-inbox-fill text-muted" style="font-size: 3rem"></i>
    <h4 class="text-center text-muted fw-lighter mt-3">
      No se encontraron techos presupuestales
    </h4>
    <p class="text-muted">
      No existen techos presupuestales registrados en el sistema o no se
      encontraron coincidencias con los filtros.
    </p>
  </div>
</div>

<!-- Componente para modales -->
<shared-custom-modal-component></shared-custom-modal-component>
